zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-1
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
n<-10
nsim<-10000
mu<-1
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
hist(z)
hist(z, breaks=30)
mean(z)
mu/sd
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)[sample(1:nsim)]
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
n<-10
nsim<-10000
mu<-2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
hist(z)
hist(z)
dev.off()
hist(z)
hist(z, breaks=100)
abline(v=mu/sd, col="red")
abline(v=mean(z), col="blue")
n<-10
nsim<-10000
mu<--2
sd<-3
se<-sd/sqrt(n)
y<-matrix(rnorm(nsim*n,mu,sd), nsim,n)
mhat<-apply(y, 1, mean)
sdhat<-apply(y, 1, sd)
sehat<-sdhat/sqrt(n)
z<-mhat/sdhat
zse<-mhat/sehat
pz<-metRology::pt.scaled(z, mean = mu/sd, sd = 1/sqrt(n), df = n-1)
pzse<-metRology::pt.scaled(zse, mean = mu/se, sd = 1, df = n-1)
par(mfrow=c(1,2))
hist(pz)
hist(pzse)
dev.off()
hist(z, breaks=100)
abline(v=mu/sd, col="red")
hist(z, breaks=1000)
hist(z, breaks=200)
abline(v=mu/sd, col="red")
abline(v=mean(z), col="red")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
dat$tss
mean(dat$tss)
mean(dat$tss, na.rm=TRUE)
range(dat$tss, na.rm=TRUE)
dat.long$y_scaled<-dat.long$y/dat.long$y.sd
dat.long$y.sv/(dat.long$y.sd^2)
sqrt(dat.long$y.sv/(dat.long$y.sd^2))
1/sqrt(dat.long$y.sv/(dat.long$y.sd^2))
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
hist(dat.long$y.sv_scaled)
hist(dat.long$y.sv_scaled, breaks=30)
min(dat.long$y.sv_scaled)
min(dat.long$y.sv_scaled, na.rm=TRUE)
min(dat.long$y_scaled, na.rm=TRUE)
hist(dat.long$y_scaled, na.rm=TRUE)
hist(dat.long$y_scaled, breaks=30)
hist(dat.long$y_scaled, breaks=30)
tGENOTYPES<-read.csv("~/Work/Bluetits/Data/Intermediate/tGENOTYPES.csv")
tEXTRACTIONS<-read.csv("~/Work/Bluetits/Data/Intermediate/tEXTRACTIONS.csv")
tSAMPLES<-read.csv("~/Work/Bluetits/Data/Intermediate/tSAMPLES.csv")
print("delete this")
tSAMPLES$collection_date<-as.character(tSAMPLES$collection_date)
tSAMPLES$collection_date[12283:nrow(tSAMPLES)]<-"2018-05-15"
tGENOTYPES$egg_id<-as.character(tSAMPLES$egg_id[match(tEXTRACTIONS$sample_id[match(tGENOTYPES$extraction_id, tEXTRACTIONS$extraction_id)], tSAMPLES$sample_id)])
tGENOTYPES$id<-as.character(tSAMPLES$bird_id[match(tEXTRACTIONS$sample_id[match(tGENOTYPES$extraction_id, tEXTRACTIONS$extraction_id)], tSAMPLES$sample_id)])
tGENOTYPES$id[which(is.na(tGENOTYPES$id))]<-tGENOTYPES$egg_id[which(is.na(tGENOTYPES$id))]
tGENOTYPES$year<-format(as.Date(tSAMPLES$collection_date), "%Y")[match(tEXTRACTIONS$sample_id[match(tGENOTYPES$extraction_id, tEXTRACTIONS$extraction_id)], tSAMPLES$sample_id)]
tGENOTYPES$unique_id<-paste(tGENOTYPES$plate, tGENOTYPES$sample_no, tGENOTYPES$extraction_id)
Gdata<-reshape(tGENOTYPES, idvar="unique_id", v.names=c("small_allele", "large_allele"), timevar=c("locus"), direction="wide")
Gdata[which(Gdata$id=="AJD1529"),]
Gdata[which(Gdata$id=="AJD1529"),c(1:7)]
Gdata[which(Gdata$id=="AJD1529"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1533"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1262"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1254"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1214"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1215"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1216"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="S955744"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="S955746"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id==paste0("S955", 694:700),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", 694:700),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", 694:700)),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", c(694:700, 710, 711)),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", c(694:700, 710, 711)),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
which(Gdata$id%in%paste0("S955", c(694:700, 710, 711))
)
Gdata[which(Gdata$id%in%paste0("S955", c(694:700, 710, 711))),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", c(694:700, 710, 711))),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("S955", c(694:700, 710, 711))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1387"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1389"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="S955930"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="S955932"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id=="AJD1121"),c(1:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%c("AJD1121", "AJD1123", "AJD1124", "AJD1125", "AJD1127")),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD", 311:317)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 311:317)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 858)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 851)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 850)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 856)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 857)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 480)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 482)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 428)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 118:127)),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%paste0("AJD1", 118:127)[9]),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[9])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[10])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[1])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[8])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[9])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[7])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[10])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127)[8])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 118:127))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_17E08"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("D518595"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1311"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_A"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 311:317)[8])),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 311:317))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_A"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", 253))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("253"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_253"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_253L"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("151L"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_151L"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_151R"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_151", c("L", "R", "B", "LB")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_253L"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c("408")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c("402")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c("406")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c("064")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_A13", c("E06")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("S955", c("9311")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("S955", c("9311")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("S955", c("931")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("18_A13", c("E06")))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD", c(548)))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c(548)))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c(403)))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("AJD1", c(403)))),c(1:2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("D518", c(687)))),c(1:2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("S955", c(712)))),c(1:2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%(paste0("S955", c(716)))),c(1:2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$extraction_id%in%(paste0("18_36LB"))),c(2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%c("S955669", "S955670", "X552490", "D518792")),c(1:2, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%c("S955669", "S955670", "X552490", "D518792")),c(1:3, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%c("S955669", "S955670", "X552490", "D518792")),c(1:7, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
Gdata[which(Gdata$id%in%c("S955669", "S955670", "X552490", "D518792")),c(2,5, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
tNEST_SURVEY
tNEST_SURVEY<-read.csv("~/Work/Bluetits/Data/Intermediate/tNEST_SURVEY.csv")
tNEST_SURVEY[which(tNEST_SURVEY$nest=="17_A58"),]
Gdata[which(Gdata$id%in%c("S955669", "S955670", "X552490", "D518792")),c(2,5, 8:9, 16:17, 20:21, 12:13, 18:19, 10:11, 14:15)]
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
qqplot((1/rgamma(1000,0.1, 0.1))~rinvgamma(10000,0.1,0.1))
qqplot((1/rgamma(1000,0.1, 0.1))~MCMCpack::rinvgamma(10000,0.1,0.1))
MCMCpack::rinvgamma(10000,0.1,0.1)
qqplot((1/rgamma(1000,0.3, 0.3))~MCMCpack::rinvgamma(10000,0.3,0.3))
qqplot((1/rgamma(1000,0.3, 0.3))~c(MCMCpack::rinvgamma(10000,0.3,0.3)))
iv<-MCMCpack::rinvgamma(10000,0.3,0.3))
iv<-MCMCpack::rinvgamma(10000,0.3,0.3)
iv
v<-1/rgamma(1000,0.3, 0.3)
qqplot(v,iv)
iv<-MCMCpack::rinvgamma(10000,2,2)
v<-1/rgamma(1000,2, 2)
qqplot(v,iv)
abline(0,1)
v<-1/rgamma(10000,2, 2)
qqplot(v,iv)
abline(0,1)
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
pd.dat
names(pd.dat)
plot(0, ylim=range(unlist(pd.dat)),xlim=range(x.dat), type="n")
for(i in c(1:7)){
lines(pd.dat[[i]]~x.dat, col=1+i%in%c(3:4))
}
plot(0, ylim=range(unlist(pd.dat[c(1:2, 5:7)])),xlim=range(x.dat), type="n")
for(i in c(1:2, 5:7)){
lines(pd.dat[[i]]~x.dat, col=i)
}
plot(0, ylim=range(unlist(pd.dat[c(1:2, 5:7)])),xlim=range(x.dat), type="n")
cnt<-0
for(i in c(1:2, 5:7)){
cnt<-cnt+1
lines(pd.dat[[i]]~x.dat, col=cnt)
}
cnt
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
warnings()
warnings()
rmarkdown::render("~/Work/Megan/R/LA.Rmd")
ls()
library(MCMCglmm)
nsim<-1000
n<-rep(6,nsim)
mu<-2
sd<-0.762
y<-sapply(n, rnorm, mean=mu, sd=sd, simplify=FALSE)
sd.hat<-unlist(lapply(y,sd))
y.sd<-unlist(lapply(y, mean))/sd.hat
df<-n-1
scale<-1/sqrt(n[1])
x<-seq(-20,20, length=1000)
dtx<-dt(x/scale, df=df[1], ncp=(mu/sd)/scale)
maxc<-max(hist(y.sd, breaks=300)$counts)
dtx<-dtx*maxc/max(dtx)
lines(dtx~x, col="red")
library(MCMCglmm)
nsim<-10000
n<-rgeom(nsim, 0.05)+5
n<-rep(6,nsim)
mu<-2
sd<-0.762
sd.b<-0.1
y<-sapply(n, rnorm, mean=mu, sd=sd, simplify=FALSE)
sd.hat<-unlist(lapply(y,sd))
mu.hat<-unlist(lapply(y, mean))+rnorm(nsim, 0, sd.b)
se<-sd.hat/sqrt(n)
y.sd<-mu.hat/sd.hat
df<-n-1
scale<-1/sqrt(n[1])
x<-seq(-20,20, length=1000)
dtx<-dt(x/scale, df=df[1], ncp=(mu/sd)/scale[1])
maxc<-max(hist(y.sd, breaks=300)$counts)
dtx<-dtx*maxc/max(dtx)
lines(dtx~x, col="red")
library(MCMCglmm)
nsim<-10000
n<-rgeom(nsim, 0.05)+5
n<-rep(6,nsim)
mu<-2
sd<-0.762
sd.b<-0.1
y<-sapply(n, rnorm, mean=mu, sd=sd, simplify=FALSE)
sd.hat<-unlist(lapply(y,sd))
mu.hat<-unlist(lapply(y, mean))+rnorm(nsim, 0, sd.b)
se<-sd.hat/sqrt(n)
y.sd<-mu.hat/sd.hat
df<-n-1
scale<-1/sqrt(n[1])
x<-seq(-20,20, length=1000)
dtx<-dt(x/scale, df=df[1], ncp=(mu/sd)*scale[1])
maxc<-max(hist(y.sd, breaks=300)$counts)
dtx<-dtx*maxc/max(dtx)
lines(dtx~x, col="red")
library(MCMCglmm)
nsim<-1000
n<-rgeom(nsim, 0.05)+5
n<-rep(6,nsim)
mu<-2
sd<-0.762
sd.b<-sqrt(0.1)
tsd<-sqrt(sd^2+sd.b^2)
y<-sapply(n, rnorm, mean=mu*tsd+rnorm(1,0, sd.b), sd=sd, simplify=FALSE)
sd.hat<-unlist(lapply(y,sd))
mu.hat<-unlist(lapply(y, mean))
se<-sd.hat/sqrt(n)
y.sd<-mu.hat/sd.hat
df<-n-1
mu/sd
mean(y.sd)
dat<-data.frame(y.sd=y.sd, se=se, df=df, scale=scale)
m1<-MCMCglmm(cbind(y.sd, scale, df)~1, data=dat, family="ncst")
library(MCMCglmm)
nsim<-1000
n<-rgeom(nsim, 0.05)+5
n<-rep(6,nsim)
mu<-2
sd<-0.762
sd.b<-sqrt(0.1)
tsd<-sqrt(sd^2+sd.b^2)
y<-sapply(n, function(x){rnorm(x, mean=mu*tsd+rnorm(1,0, sd.b), sd=sd)}, simplify=FALSE)
var(y)
library(MCMCglmm)
nsim<-1000
n<-rgeom(nsim, 0.05)+5
n<-rep(6,nsim)
mu<-2
sd<-0.762
sd.b<-sqrt(0.1)
tsd<-sqrt(sd^2+sd.b^2)
y<-sapply(n, function(x){rnorm(x, mean=mu/sd+rnorm(1,0, sd.b)/sd, sd=sd)}, simplify=FALSE)
sd.hat<-unlist(lapply(y,sd))
mu.hat<-unlist(lapply(y, mean))
se<-sd.hat/sqrt(n)
y.sd<-mu.hat/sd.hat
df<-n-1
scale<-1/sqrt(n)
x<-seq(-20,20, length=1000)
dtx<-dt(x/scale[1], df=df[1], ncp=(mu/sd)/scale[1])
maxc<-max(hist(y.sd, breaks=300)$counts)
dtx<-dtx*maxc/max(dtx)
lines(dtx~x, col="red")
dat<-data.frame(y.sd=y.sd, se=se, df=df, mu.hat=mu.hat, scale=scale)
m1<-MCMCglmm(cbind(y.sd, scale, df)~1, data=dat, family="ncst")
sour
X<-Matrix(sample(0:1,25, replace=TRUE),5,5)
dim(X)
X
X<-as(Matrix(sample(0:1,25, replace=TRUE),5,5), "sparseMatrix")
X
X@p
0:nd
setwd(MCpath)
MCpath="~/Work/AManal/MCMCglmm_2.19/vignettes/"
setwd(MCpath)
Sweave("article.Rnw")
MCpath
res37<-matrix(0, nsim, 3)
prior<-list(R=list(V=1, fix=1), G=list(G1=list(V=1, nu=1, alpha.mu=0, alpha.V=100)))
tpar<-c(0,1,1)
tree<-rcoal(100)
y<-rbv(tree, diag(1), nodes="TIPS")+rnorm(100)
A<-inverseA(tree)
data=data.frame(y=as.numeric(y>0), species=tree$tip.label)
m1<-MCMCglmm(y~1, random=~species, rcov=~units, family="threshold", ginv=list(species=A$Ainv),verbose=verbose,  data=data, prior=prior, nitt=nitt, thin=thin, burnin=burnin)
verbose=FALSE
plotit=FALSE
DICtest=TRUE
SUMtest=TRUE
nsim<-50
nitt<-13000
thin<-10
burnin<-3000
m1<-MCMCglmm(y~1, random=~species, rcov=~units, family="threshold", ginv=list(species=A$Ainv),verbose=verbose,  data=data, prior=prior, nitt=nitt, thin=thin, burnin=burnin)
summary(m1)
var(y)
tree
plot(tree)
y
data$y
res37<-matrix(0, nsim, 3)
prior<-list(R=list(V=1, fix=1), G=list(G1=list(V=1, nu=1, alpha.mu=0, alpha.V=100)))
tpar<-c(0,1,1)
tree<-rcoal(100)
y<-rbv(tree, diag(1), nodes="TIPS")+rnorm(100)
A<-inverseA(tree)
data=data.frame(y=as.numeric(y>0), species=tree$tip.label)
m1<-MCMCglmm(y~1, random=~species, rcov=~units, family="threshold", ginv=list(species=A$Ainv),verbose=verbose,  data=data, prior=prior, nitt=nitt, thin=thin, burnin=burnin)
summary(m1)
tree<-rcoal(100)
y<-rbv(tree, diag(1), nodes="TIPS")+rnorm(100)
A<-inverseA(tree)
data=data.frame(y=as.numeric(y>0), species=tree$tip.label)
m1<-MCMCglmm(y~1, random=~species, rcov=~units, family="threshold", ginv=list(species=A$Ainv),verbose=verbose,  data=data, prior=prior, nitt=nitt, thin=thin, burnin=burnin)
summary(m1)
